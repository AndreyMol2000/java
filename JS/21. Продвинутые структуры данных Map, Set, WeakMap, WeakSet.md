# 21. Продвинутые структуры данных: Map, Set, WeakMap, WeakSet

Эти структуры позволяют хранить данные эффективнее и гибче, чем обычные объекты и массивы.

## 21.1 Map

* Коллекция ключ-значение, где ключи могут быть любого типа

```javascript
let map = new Map();
map.set('name', 'John');
map.set(123, 'Number key');
console.log(map.get('name')); // John
console.log(map.has(123));    // true
map.delete('name');
console.log(map.size);         // 1
```

* Методы: `set`, `get`, `delete`, `has`, `clear`

## 21.2 Set

* Коллекция уникальных значений

```javascript
let set = new Set([1,2,2,3]);
console.log(set); // Set {1,2,3}
set.add(4);
set.delete(2);
console.log(set.has(3)); // true
```

* Методы: `add`, `delete`, `has`, `clear`
* Можно перебирать: `for..of` или `forEach`

## 21.3 WeakMap

* Map с ключами только объектного типа
* Сборка мусора удаляет объекты, если на них больше нет ссылок

```javascript
let wm = new WeakMap();
let obj = {};
wm.set(obj, 'value');
console.log(wm.get(obj)); // value
obj = null; // объект будет удален сборщиком мусора
```

* Методы: `set`, `get`, `delete`, `has`

## 21.4 WeakSet

* Set с объектами, ссылающимися слабо
* Объекты автоматически удаляются сборщиком мусора

```javascript
let ws = new WeakSet();
let obj = {a:1};
ws.add(obj);
console.log(ws.has(obj)); // true
obj = null; // объект удалится автоматически
```

## Советы

* Map и Set удобны, когда нужны уникальные значения или сложные ключи
* WeakMap и WeakSet полезны для хранения приватных данных и предотвращения утечек памяти
* Перебор WeakMap/WeakSet невозможен напрямую, только через хранение ссылок на объекты
